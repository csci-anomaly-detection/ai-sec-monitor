{
  "detection_method": "detect_anomalies_advanced",
  "timestamp": "2025-10-27T14:30:00Z",
  "anomalies": [
    {
      "window_index": 0,
      "anomaly_score": -0.72,
      "severity": "high",
      "suspicious_features": [
        "requests_per_minute (z=3.2)",
        "error_rate (z=2.1)",
        "unique_client_ips (z=2.8)",
        "port_diversity (z=2.3)",
        "avg_request_interval (z=2.5)"
      ],
      "features": {
        "total_requests": 156.0,
        "requests_per_minute": 30.5,
        "requests_per_second": 0.51,
        "error_rate": 0.05,
        "client_error_rate": 0.03,
        "success_rate": 0.92,
        "redirect_rate": 0.0,
        "unique_client_ips": 5.0,
        "avg_requests_per_ip": 31.2,
        "client_ip_entropy": 1.85,
        "port_diversity": 8.0,
        "suspicious_port_ratio": 0.65,
        "hour_of_day": 14,
        "day_of_week": 2,
        "is_weekend": 0.0,
        "is_business_hours": 1.0,
        "is_night_time": 0.0,
        "alert_diversity": 12.0,
        "signature_diversity": 8.0,
        "avg_priority": 2.3,
        "high_priority_ratio": 0.45,
        "avg_duration": 125.0,
        "max_duration": 850.0,
        "duration_stddev": 95.5,
        "slow_request_ratio": 0.08,
        "protocol_diversity": 2.0,
        "tcp_ratio": 0.95,
        "udp_ratio": 0.05,
        "avg_request_interval": 1.2,
        "request_interval_stddev": 0.8,
        "min_request_interval": 0.1
      }
    },
    {
      "window_index": 2,
      "anomaly_score": -0.58,
      "severity": "medium",
      "suspicious_features": [
        "requests_per_minute (z=2.4)",
        "error_rate (z=2.7)",
        "high_priority_ratio (z=2.1)"
      ],
      "features": {
        "total_requests": 89.0,
        "requests_per_minute": 17.8,
        "requests_per_second": 0.30,
        "error_rate": 0.12,
        "client_error_rate": 0.08,
        "success_rate": 0.80,
        "redirect_rate": 0.0,
        "unique_client_ips": 3.0,
        "avg_requests_per_ip": 29.7,
        "client_ip_entropy": 1.35,
        "port_diversity": 5.0,
        "suspicious_port_ratio": 0.55,
        "hour_of_day": 14,
        "day_of_week": 2,
        "is_weekend": 0.0,
        "is_business_hours": 1.0,
        "is_night_time": 0.0,
        "alert_diversity": 8.0,
        "signature_diversity": 6.0,
        "avg_priority": 2.1,
        "high_priority_ratio": 0.52,
        "avg_duration": 145.0,
        "max_duration": 1200.0,
        "duration_stddev": 125.0,
        "slow_request_ratio": 0.15,
        "protocol_diversity": 1.0,
        "tcp_ratio": 1.0,
        "udp_ratio": 0.0,
        "avg_request_interval": 2.1,
        "request_interval_stddev": 1.2,
        "min_request_interval": 0.3
      }
    }
  ],
  "summary": {
    "total_anomalies": 2,
    "high_severity_count": 1,
    "medium_severity_count": 1,
    "lowest_score": -0.72,
    "average_score": -0.65,
    "most_suspicious_window": 0
  },
  "wrapper_output": {
    "detection_method": "run_isolation_forest",
    "anomalies_detected": 2,
    "most_severe_score": -0.72,
    "severity": "high",
    "suspicious_features": [
      "requests_per_minute (z=3.2)",
      "error_rate (z=2.1)",
      "unique_client_ips (z=2.8)",
      "port_diversity (z=2.3)",
      "avg_request_interval (z=2.5)"
    ],
    "all_anomalies": [
      {
        "window_index": 0,
        "anomaly_score": -0.72,
        "severity": "high",
        "suspicious_features": [
          "requests_per_minute (z=3.2)",
          "error_rate (z=2.1)",
          "unique_client_ips (z=2.8)",
          "port_diversity (z=2.3)",
          "avg_request_interval (z=2.5)"
        ],
        "features": {
          "total_requests": 156.0,
          "requests_per_minute": 30.5,
          "requests_per_second": 0.51,
          "error_rate": 0.05,
          "client_error_rate": 0.03,
          "success_rate": 0.92,
          "redirect_rate": 0.0,
          "unique_client_ips": 5.0,
          "avg_requests_per_ip": 31.2,
          "client_ip_entropy": 1.85,
          "port_diversity": 8.0,
          "suspicious_port_ratio": 0.65,
          "hour_of_day": 14,
          "day_of_week": 2,
          "is_weekend": 0.0,
          "is_business_hours": 1.0,
          "is_night_time": 0.0,
          "alert_diversity": 12.0,
          "signature_diversity": 8.0,
          "avg_priority": 2.3,
          "high_priority_ratio": 0.45,
          "avg_duration": 125.0,
          "max_duration": 850.0,
          "duration_stddev": 95.5,
          "slow_request_ratio": 0.08,
          "protocol_diversity": 2.0,
          "tcp_ratio": 0.95,
          "udp_ratio": 0.05,
          "avg_request_interval": 1.2,
          "request_interval_stddev": 0.8,
          "min_request_interval": 0.1
        }
      },
      {
        "window_index": 2,
        "anomaly_score": -0.58,
        "severity": "medium",
        "suspicious_features": [
          "requests_per_minute (z=2.4)",
          "error_rate (z=2.7)",
          "high_priority_ratio (z=2.1)"
        ],
        "features": {
          "total_requests": 89.0,
          "requests_per_minute": 17.8,
          "requests_per_second": 0.30,
          "error_rate": 0.12,
          "client_error_rate": 0.08,
          "success_rate": 0.80,
          "redirect_rate": 0.0,
          "unique_client_ips": 3.0,
          "avg_requests_per_ip": 29.7,
          "client_ip_entropy": 1.35,
          "port_diversity": 5.0,
          "suspicious_port_ratio": 0.55,
          "hour_of_day": 14,
          "day_of_week": 2,
          "is_weekend": 0.0,
          "is_business_hours": 1.0,
          "is_night_time": 0.0,
          "alert_diversity": 8.0,
          "signature_diversity": 6.0,
          "avg_priority": 2.1,
          "high_priority_ratio": 0.52,
          "avg_duration": 145.0,
          "max_duration": 1200.0,
          "duration_stddev": 125.0,
          "slow_request_ratio": 0.15,
          "protocol_diversity": 1.0,
          "tcp_ratio": 1.0,
          "udp_ratio": 0.0,
          "avg_request_interval": 2.1,
          "request_interval_stddev": 1.2,
          "min_request_interval": 0.3
        }
      }
    ]
  },
  "explanation": {
    "anomaly_score_meaning": "More negative scores indicate higher anomaly. Range typically -1.0 (very anomalous) to 1.0 (normal).",
    "severity_calculation": "high if score < -0.6, otherwise medium",
    "suspicious_features": "Features with z-score > 2.0 are flagged as suspicious. Shows top 5 most deviant features.",
    "window_index": "Time window identifier (0 = first window, 1 = second, etc.)",
    "features": "All extracted features from the time window. These are the inputs that the Isolation Forest model analyzed."
  }
}

