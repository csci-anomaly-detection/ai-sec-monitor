# Fire on SYN so we don't depend on replies
alert tcp any any -> 10.77.10.10 80   (msg:"DEMO HTTP SYN to DMZ web"; flags:S; sid:990101; rev:1;)
alert tcp any any -> 10.77.10.30 2222 (msg:"DEMO SSH SYN to Cowrie :2222"; flags:S; sid:990102; rev:1;)
alert tcp any any -> any any (msg:"Nmap Scan Detected"; flags:S,!A; threshold: type both, track by_src, count 10, seconds 5; reference:url,nmap.org; classtype:attempted-recon; sid:1000001; rev:2;)
alert http any any -> any any (msg:"SQL Injection Attempt - UNION"; flow:established,to_server; content:"UNION"; http_uri; nocase; content:"SELECT"; http_uri; nocase; distance:0; within:20; classtype:web-application-attack; sid:1000010; rev:1;)
alert http any any -> any any (msg:"SQL Injection Attempt - OR 1=1"; flow:established,to_server; content:"OR"; http_uri; nocase; content:"1=1"; http_uri; nocase; distance:0; within:10; classtype:web-application-attack; sid:1000011; rev:1;)
alert http any any -> any any (msg:"SQL Injection Attempt - Single Quote"; flow:established,to_server; content:"'"; http_uri; pcre:"/('.*){3,}/i"; classtype:web-application-attack; sid:1000012; rev:1;)
alert http any any -> any any (msg:"XSS Attempt - Script Tag"; flow:established,to_server; content:"<script"; http_uri; nocase; classtype:web-application-attack; sid:1000020; rev:1;)
alert http any any -> any any (msg:"XSS Attempt - JavaScript Event"; flow:established,to_server; content:"onerror"; http_uri; nocase; content:"alert"; http_uri; nocase; distance:0; within:50; classtype:web-application-attack; sid:1000021; rev:1;)
alert http any any -> any any (msg:"XSS Attempt - IMG Tag"; flow:established,to_server; content:"<img"; http_uri; nocase; content:"onerror"; http_uri; nocase; distance:0; within:50; classtype:web-application-attack; sid:1000022; rev:1;)
alert http any any -> any any (msg:"Command Injection - Linux Commands"; flow:established,to_server; content:"; cat"; http_uri; nocase; classtype:web-application-attack; sid:1000030; rev:1;)
alert http any any -> any any (msg:"Command Injection - Pipe Command"; flow:established,to_server; content:"|"; http_uri; content:"whoami"; http_uri; nocase; distance:0; within:20; classtype:web-application-attack; sid:1000031; rev:1;)
alert http any any -> any any (msg:"Command Injection - System Files"; flow:established,to_server; content:"/etc/passwd"; http_uri; nocase; classtype:web-application-attack; sid:1000032; rev:1;)
alert http any any -> any any (msg:"Directory Traversal Attempt"; flow:established,to_server; content:"../"; http_uri; threshold: type both, track by_src, count 3, seconds 60; classtype:web-application-attack; sid:1000040; rev:1;)
alert http any any -> any any (msg:"Directory Traversal - etc/passwd"; flow:established,to_server; content:"../"; http_uri; content:"/etc/passwd"; http_uri; nocase; distance:0; classtype:web-application-attack; sid:1000041; rev:1;)
alert http any any -> any any (msg:"Malicious File Upload - PHP"; flow:established,to_server; content:"Content-Disposition"; http_header; content:".php"; http_header; nocase; distance:0; classtype:web-application-attack; sid:1000050; rev:1;)
alert http any any -> any any (msg:"Web Shell Upload Attempt"; flow:established,to_server; content:"<?php"; http_client_body; content:"system"; http_client_body; nocase; distance:0; within:100; classtype:web-application-attack; sid:1000051; rev:1;)
alert http any any -> any any (msg:"HTTP Brute Force Login Attempt"; flow:established,to_server; content:"POST"; http_method; content:"username"; http_client_body; content:"password"; http_client_body; distance:0; threshold: type both, track by_src, count 5, seconds 60; classtype:attempted-admin; sid:1000060; rev:1;)
